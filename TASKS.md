# Чек‑лист синхронизации Telegram‑бота **pricebot**

> **Важно:** На той же виртуалке работают другие проекты. Любые действия **не должны** останавливать или изменять чужие контейнеры.
>
> **Пример подключения к VM** (оставляем как справку):
> ```bash
> ssh -i /Users/yuprozorov/ssh-key price-robot-vm@89.169.152.79
> ssh price-robot-vm "cd pricebot && docker-compose ps"
> ```
>
> Отмечайте выполненные пункты, подставляя `x` в `[ ]`.

---

## 1. Проверка доступа к виртуалке
- [x] Настроить удобный алиас SSH для быстрого доступа.
- [x] Убедиться, что подключение проходит без ошибок.

## 2. Инвентаризация контейнеров проекта *pricebot*
- [x] Определить, какие контейнеры относятся именно к pricebot.
- [x] Зафиксировать их текущее состояние и конфигурации.

## 3. Создание «холодного» бэкапа кода на сервере
- [x] Скопировать актуальный каталог приложения из контейнера.
- [x] Сохранить архив бэкапа в безопасном месте на сервере.

## 4. Генерация контрольных сумм на сервере
- [x] Создать список SHA‑256 всех файлов из бэкапа.
- [x] Передать файл контрольных сумм на локальную машину.

## 5. Сравнение локальной копии с продовой
- [x] Сформировать контрольные суммы локальных файлов.
- [x] Сравнить их с продовым списком и зафиксировать различия.

## 6. Приведение локали к продовому состоянию
- [x] Восстановить отсутствующие или изменённые файлы из бэкапа.
- [x] Составить перечень лишних локальных файлов и удалить ненужное.
- [x] Проверить, что бот собирается и запускается локально без ошибок.

## 7. Начальная инициализация GitLab‑репозитория
- [x] Создать или подключить репозиторий GitLab.
- [x] Добавить базовый `.gitignore` и сделать коммит «prod snapshot».
- [x] Создать ветку `dev` для дальнейшей разработки.

## 8. Очистка неиспользуемого кода (ветка *dev*)
- [x] Провести статический анализ, выявив «мёртвый» код и неиспользуемые файлы.
- [x] Удалить или заархивировать их, делая отдельные коммиты.
- [x] Подготовить Merge‑Request `dev → main` на ревью.

## 9. Работа с секретами
- [ ] Создать шаблон `.env.example` без значений.
- [ ] Перенести реальные переменные окружения в Secrets GitLab CI.
- [ ] При необходимости удалить `.env` из истории репозитория.

## 10. Настройка CI/CD
- [ ] Добавить pipeline со стадиями **lint → test → build → deploy**.
- [ ] Убедиться, что pipeline успешно выполняется end‑to‑end.

## 11. Защита ветки *main*
- [ ] Сделать `main` защищённой, запретив прямые push.
- [ ] Включить обязательное ревью и push‑rules (нет debug/print/ключей).

## 12. Актуализация документации
- [ ] Обновить `README.md` (подключение к VM, локальный запуск, деплой).
- [ ] Создать `docs/ARCHITECTURE.md` с обзором контейнеров и тегов.
- [ ] *(По желанию)* Настроить публикацию документации через MkDocs или GitLab Pages.

---

> Чек‑лист готов. Отмечайте галочками — так будет видно, что уже сделано, а что ещё предстоит.

